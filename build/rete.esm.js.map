{"version":3,"file":"rete.esm.js","sources":["../src/engine/component.ts","../src/node.ts","../src/component.ts","../src/connection.ts","../src/control.ts","../src/core/emitter.ts","../src/io.ts","../src/input.ts","../src/core/validator.ts","../src/core/context.ts","../src/view/utils.ts","../src/view/drag.ts","../src/view/zoom.ts","../src/view/area.ts","../src/view/connection.ts","../src/view/control.ts","../src/view/socket.ts","../src/view/node.ts","../src/view/index.ts","../src/selected.ts","../src/core/events.ts","../src/events.ts","../src/editor.ts","../src/output.ts","../src/socket.ts","../src/engine/recursion.ts","../src/engine/state.ts","../src/engine/events.ts","../src/engine/index.ts","../src/index.ts"],"sourcesContent":["import { Engine } from './index';\r\nimport { NodeData, WorkerInputs, WorkerOutputs } from '../core/data';\r\n\r\nexport abstract class Component {\r\n\r\n    name: string;\r\n    data: unknown = {};\r\n    engine: Engine | null = null;\r\n\r\n    constructor(name: string) {\r\n        this.name = name;\r\n    }\r\n\r\n    abstract worker(node: NodeData, inputs: WorkerInputs, outputs: WorkerOutputs, ...args: unknown[]): void;\r\n}","import { Connection } from './connection';\r\nimport { Control } from './control';\r\nimport { Input } from './input';\r\nimport { Output } from './output';\r\nimport { InputsData, NodeData, OutputsData } from './core/data';\r\n\r\nexport class Node {\r\n\r\n    name: string;\r\n    id: number;\r\n    position: [number, number] = [0.0, 0.0];\r\n    inputs = new Map<string, Input>();\r\n    outputs = new Map<string, Output>();\r\n    controls = new Map<string, Control>();\r\n    data: {[key: string]: unknown} = {};\r\n    meta: {[key: string]: unknown} = {};\r\n\r\n    static latestId = 0;\r\n    \r\n    constructor(name: string) {\r\n        this.name = name;\r\n        this.id = Node.incrementId();\r\n    }\r\n\r\n    _add<T extends any>(list: Map<string, T>, item: T, prop: string) {\r\n        if (list.has(item.key))\r\n            throw new Error(`Item with key '${item.key}' already been added to the node`);\r\n        if (item[prop] !== null)\r\n            throw new Error('Item has already been added to some node');\r\n        \r\n        item[prop] = this;\r\n        list.set(item.key, item);\r\n    }\r\n\r\n    addControl(control: Control) {\r\n        this._add(this.controls, control, 'parent');\r\n        return this;\r\n    }\r\n\r\n    removeControl(control: Control) {\r\n        control.parent = null;\r\n\r\n        this.controls.delete(control.key);\r\n    }\r\n\r\n    addInput(input: Input) {\r\n        this._add(this.inputs, input, 'node');\r\n        return this;\r\n    }\r\n\r\n    removeInput(input: Input) {\r\n        input.removeConnections();\r\n        input.node = null;\r\n\r\n        this.inputs.delete(input.key);\r\n    }\r\n\r\n    addOutput(output: Output) {\r\n        this._add(this.outputs, output, 'node');\r\n        return this;\r\n    }\r\n\r\n    removeOutput(output: Output) {\r\n        output.removeConnections();\r\n        output.node = null;\r\n\r\n        this.outputs.delete(output.key);\r\n    }\r\n\r\n    getConnections() {\r\n        const ios = [...this.inputs.values(), ...this.outputs.values()];\r\n        const connections = ios.reduce((arr, io) => {\r\n            return [...arr, ...io.connections];\r\n        }, [] as Connection[]);\r\n\r\n        return connections;\r\n    }\r\n\r\n    update() {}\r\n\r\n    static incrementId() {\r\n        if (!this.latestId)\r\n            this.latestId = 1\r\n        else\r\n            this.latestId++\r\n        return this.latestId\r\n    }\r\n\r\n    static resetId() {\r\n        this.latestId = 0;\r\n    }\r\n\r\n    toJSON(): NodeData {\r\n        const reduceIO = <T extends any>(list: Map<string, Input | Output>) => {\r\n            return Array.from(list).reduce<T>((obj, [key, io]) => {\r\n                obj[key] = io.toJSON();\r\n                return obj;\r\n            }, {} as any)\r\n        }\r\n\r\n        return {\r\n            'id': this.id,\r\n            'data': this.data,\r\n            'inputs': reduceIO<InputsData>(this.inputs),\r\n            'outputs': reduceIO<OutputsData>(this.outputs),\r\n            'position': this.position,\r\n            'name': this.name\r\n        }\r\n    }\r\n\r\n    static fromJSON(json: NodeData) {\r\n        const node = new Node(json.name);\r\n        const [x, y] = json.position;\r\n\r\n        node.id = json.id;\r\n        node.data = json.data;\r\n        node.position = [x, y];\r\n        node.name = json.name;\r\n        Node.latestId = Math.max(node.id, Node.latestId);\r\n\r\n        return node;\r\n    }\r\n}\r\n","import { Component as ComponentWorker } from './engine/component';\r\nimport { Node } from './node';\r\nimport { NodeEditor } from './editor';\r\n\r\nexport abstract class Component extends ComponentWorker {\r\n\r\n    editor: NodeEditor | null = null;\r\n    data: unknown = {};\r\n\r\n    constructor(name: string) {\r\n        super(name);\r\n    }\r\n\r\n    abstract async builder(node: Node): Promise<void>;\r\n\r\n    async build(node: Node) {\r\n        await this.builder(node);\r\n\r\n        return node;\r\n    }\r\n\r\n    async createNode(data = {}) {\r\n        const node = new Node(this.name);\r\n        \r\n        node.data = data;\r\n        await this.build(node);\r\n\r\n        return node;\r\n    }\r\n}","import { Input } from './input';\r\nimport { Output } from './output';\r\n\r\nexport class Connection {\r\n\r\n    output: Output;\r\n    input: Input;\r\n    data: unknown = {};\r\n\r\n    constructor(output: Output, input: Input) {\r\n        this.output = output;\r\n        this.input = input;\r\n        this.data = {};\r\n\r\n        this.input.addConnection(this);\r\n    }\r\n\r\n    remove() {\r\n        this.input.removeConnection(this);\r\n        this.output.removeConnection(this);\r\n    }\r\n}","import { Input } from './input';\r\nimport { Node } from './node';\r\n\r\nexport class Control {\r\n\r\n    key: string;\r\n    data: unknown = {};\r\n    parent: Node | Input | null = null;\r\n\r\n    constructor(key: string) {\r\n        if (this.constructor === Control)\r\n            throw new TypeError('Can not construct abstract class');\r\n        if (!key)\r\n            throw new Error('The key parameter is missing in super() of Control ');\r\n\r\n        this.key = key;\r\n    }\r\n\r\n    getNode() {\r\n        if (this.parent === null)\r\n            throw new Error('Control isn\\'t added to Node/Input');   \r\n        \r\n        if (this.parent instanceof Node)\r\n            return this.parent;\r\n            \r\n        if (!this.parent.node)\r\n            throw new Error('Control hasn\\'t be added to Input or Node');\r\n\r\n        return this.parent.node;\r\n    }\r\n\r\n    getData(key: string) {\r\n        return this.getNode().data[key];\r\n    }\r\n\r\n    putData(key: string, data: unknown) {\r\n        this.getNode().data[key] = data;\r\n    }  \r\n}","import { Events } from './events';\r\n\r\nexport class Emitter<EventTypes> {\r\n\r\n    events: {[key: string]: Function[]} = {};\r\n    silent = false;\r\n\r\n    constructor(events: Events | Emitter<EventTypes>) {\r\n        this.events = events instanceof Emitter ? events.events : events.handlers;\r\n    }\r\n\r\n    on<K extends keyof EventTypes>(names: K | K[], handler: (args: EventTypes[K]) => void | unknown): this {\r\n        const events = names instanceof Array ? names : (names as string).split(' ');\r\n\r\n        (events as string[]).forEach(name => {\r\n            if (!this.events[name])\r\n                throw new Error(`The event ${name} does not exist`);\r\n            this.events[name].push(handler);\r\n        });\r\n\r\n        return this;\r\n    }\r\n\r\n    trigger<K extends keyof EventTypes>(name: K, params: EventTypes[K] | {} = {}) {\r\n        if (!(name in this.events))\r\n            throw new Error(`The event ${name} cannot be triggered`);\r\n\r\n        return this.events[name as string].reduce((r: boolean, e: Function) => {\r\n            return (e(params) !== false) && r\r\n        }, true); // return false if at least one event is false        \r\n    }\r\n\r\n    bind(name: string) {\r\n        if (this.events[name])\r\n            throw new Error(`The event ${name} is already bound`);\r\n\r\n        this.events[name] = [];\r\n    }\r\n\r\n    exist(name: string) {\r\n        return Array.isArray(this.events[name]);\r\n    }\r\n}","import { Connection } from './connection';\r\nimport { Node } from './node';\r\nimport { Socket } from './socket';\r\n\r\nexport class IO {\r\n\r\n    node: Node | null = null;\r\n    multipleConnections: boolean;\r\n    connections: Connection[] = [];\r\n   \r\n    key: string;\r\n    name: string;\r\n    socket: Socket;\r\n\r\n    constructor(key: string, name: string, socket: Socket, multiConns: boolean) {\r\n\t    this.node = null;\r\n        this.multipleConnections = multiConns;\r\n        this.connections = [];\r\n\t   \r\n        this.key = key;\r\n        this.name = name;\r\n        this.socket = socket;\r\n    }\r\n    \r\n    removeConnection(connection: Connection) {\r\n        this.connections.splice(this.connections.indexOf(connection), 1);\r\n    }\r\n\r\n    removeConnections() {\r\n        this.connections.forEach(connection => this.removeConnection(connection));\r\n    }\r\n}","import { Connection } from './connection';\r\nimport { Control } from './control';\r\nimport { IO } from './io';\r\nimport { InputData } from './core/data';\r\nimport { Socket } from './socket';\r\n\r\nexport class Input extends IO {\r\n   \r\n    control: Control | null = null;\r\n\r\n    constructor(key: string, title: string, socket: Socket, multiConns: boolean = false) {\r\n        super(key, title, socket, multiConns);\r\n    }\r\n\r\n    hasConnection() {\r\n        return this.connections.length > 0;\r\n    }\r\n\r\n    addConnection(connection: Connection) {\r\n        if (!this.multipleConnections && this.hasConnection())\r\n            throw new Error('Multiple connections not allowed');\r\n        this.connections.push(connection);\r\n    }\r\n\r\n    addControl(control: Control) {\r\n        this.control = control;\r\n        control.parent = this;\r\n    }\r\n\r\n    showControl() {\r\n        return !this.hasConnection() && this.control !== null;\r\n    }\r\n\r\n    toJSON(): InputData {\r\n        return {\r\n            'connections': this.connections.map(c => {\r\n                if (!c.output.node) throw new Error('Node not added to Output');\r\n\r\n                return {\r\n                    node: c.output.node.id,\r\n                    output: c.output.key,\r\n                    data: c.data\r\n                };\r\n            })\r\n        };\r\n    }\r\n}","import { Data } from './data';\r\n\r\nexport class Validator {\r\n\r\n    static isValidData(data: Data) {\r\n        return typeof data.id === 'string' &&\r\n            this.isValidId(data.id) &&\r\n            data.nodes instanceof Object && !(data.nodes instanceof Array);\r\n    }\r\n\r\n    static isValidId(id: string) {\r\n        return /^[\\w-]{3,}@[0-9]+\\.[0-9]+\\.[0-9]+$/.test(id);\r\n    }\r\n\r\n    static validate(id: string, data: Data) {\r\n        const id1 = id.split('@');\r\n        const id2 = data.id.split('@');\r\n        let msg = [];\r\n\r\n        if (!this.isValidData(data))\r\n            msg.push('Data is not suitable'); \r\n        if (id !== data.id)\r\n            msg.push('IDs not equal');\r\n        if (id1[0] !== id2[0])\r\n            msg.push('Names don\\'t match');\r\n        if (id1[1] !== id2[1])\r\n            msg.push('Versions don\\'t match');\r\n\r\n        return { success: Boolean(!msg.length), msg: msg.join('. ') };\r\n    }\r\n}","import { Component } from '../engine/component';\r\nimport { Emitter } from './emitter'\r\nimport { Validator } from './validator'\r\nimport { EventsTypes as DefaultEvents, Events } from './events';\r\nimport { Plugin, PluginParams } from './plugin';\r\n\r\nexport class Context<EventsTypes> extends Emitter<EventsTypes & DefaultEvents> {\r\n\r\n    id: string;\r\n    plugins: Map<string, unknown>;\r\n    components: Map<string, Component>;\r\n\r\n    constructor(id: string, events: Events) {\r\n        super(events);\r\n\r\n        if (!Validator.isValidId(id))\r\n            throw new Error('ID should be valid to name@0.1.0 format');  \r\n        \r\n        this.id = id;\r\n        this.plugins = new Map();\r\n        this.components = new Map();\r\n    }\r\n\r\n    use<T extends Plugin, O extends PluginParams<T>>(plugin: T, options?: O) {\r\n        if (plugin.name && this.plugins.has(plugin.name)) throw new Error(`Plugin ${plugin.name} already in use`)\r\n\r\n        plugin.install(this, options || {});\r\n        this.plugins.set(plugin.name, options)\r\n    }\r\n\r\n    register(component: Component) {\r\n        if (this.components.has(component.name))\r\n            throw new Error(`Component ${component.name} already registered`);\r\n\r\n        this.components.set(component.name, component);\r\n        this.trigger('componentregister', component);\r\n    }\r\n\r\n    destroy() {\r\n        this.trigger('destroy');\r\n    }\r\n}","export function listenWindow<K extends keyof WindowEventMap>(event: K, handler: (e: WindowEventMap[K]) => void) {\r\n    window.addEventListener(event, handler);\r\n    \r\n    return () => {\r\n        window.removeEventListener<K>(event, handler);\r\n    }\r\n}","import { listenWindow } from './utils';\r\n\r\nexport class Drag {\r\n\r\n    pointerStart: [number, number] | null;\r\n    el: HTMLElement;\r\n    destroy: () => void;\r\n\r\n    constructor(\r\n        el: HTMLElement,\r\n        private onTranslate = (_x: number, _y: number, _e: PointerEvent) => {},\r\n        private onStart = (_e: PointerEvent) => {},\r\n        private onDrag = (_e: PointerEvent) => {}\r\n    ) {\r\n        this.pointerStart = null;\r\n        this.el = el;\r\n\r\n        this.destroy = this.initEvents();\r\n    }\r\n\r\n    initEvents() {\r\n        this.el.style.touchAction = 'none';\r\n        this.el.addEventListener('pointerdown', this.down.bind(this));\r\n\r\n        const destroyMove = listenWindow('pointermove', this.move.bind(this));\r\n        const destroyUp = listenWindow('pointerup', this.up.bind(this));\r\n\r\n        return () => { destroyMove(); destroyUp(); }\r\n    }\r\n\r\n    down(e: PointerEvent) {\r\n        e.stopPropagation();\r\n        this.pointerStart = [e.pageX, e.pageY]\r\n\r\n        this.onStart(e);\r\n    }\r\n\r\n    move(e: PointerEvent) {\r\n        if (!this.pointerStart) return;\r\n        e.preventDefault();\r\n\r\n        let [x, y] = [e.pageX, e.pageY]\r\n\r\n        let delta = [x - this.pointerStart[0], y - this.pointerStart[1]];\r\n\r\n        let zoom = this.el.getBoundingClientRect().width / this.el.offsetWidth;\r\n\r\n        this.onTranslate(delta[0] / zoom, delta[1] / zoom, e);\r\n    }\r\n\r\n    up(e: PointerEvent) {\r\n        if (!this.pointerStart) return;\r\n        \r\n        this.pointerStart = null;\r\n        this.onDrag(e);\r\n    }\r\n}","interface DeltaWheelEvent { wheelDelta: number }\r\n\r\nexport class Zoom {\r\n\r\n    el: HTMLElement;\r\n    intensity: number;\r\n    onzoom: Function;\r\n    onlock: Function;\r\n    previous: { cx: number; cy: number; distance: number } | null = null;\r\n\r\n    pointers: PointerEvent[] = [];\r\n\r\n    constructor(container: HTMLElement, el: HTMLElement, intensity: number, onzoom: Function, onlock: Function) {\r\n        this.el = el;\r\n        this.intensity = intensity;\r\n        this.onzoom = onzoom;\r\n        this.onlock = onlock;\r\n\r\n        container.addEventListener('wheel', this.wheel.bind(this));\r\n        container.addEventListener('pointerdown', this.down.bind(this));\r\n        container.addEventListener('pointermove', this.move.bind(this));\r\n        container.addEventListener('pointerup', this.end.bind(this));\r\n        container.addEventListener('pointercancel', this.end.bind(this));\r\n        container.addEventListener('dblclick', this.dblclick.bind(this));\r\n    }\r\n\r\n    wheel(e: WheelEvent) {\r\n        e.preventDefault();\r\n        \r\n        const rect = this.el.getBoundingClientRect();\r\n        const wheelDelta = (e as unknown as DeltaWheelEvent).wheelDelta;\r\n        const delta = (wheelDelta ? wheelDelta / 120 : - e.deltaY / 3) * this.intensity;\r\n\r\n        const ox = (rect.left - e.clientX) * delta;\r\n        const oy = (rect.top - e.clientY) * delta;\r\n\r\n        this.onzoom(delta, ox, oy, 'wheel');\r\n    }\r\n\r\n    touches() {\r\n        let e = { touches: this.pointers }\r\n        let [x1, y1] = [e.touches[0].clientX, e.touches[0].clientY];\r\n        let [x2, y2] = [e.touches[1].clientX, e.touches[1].clientY];\r\n\r\n        let distance = Math.sqrt(Math.pow(x1 - x2, 2) + Math.pow(y1 - y2, 2));\r\n\r\n        return {\r\n            cx: (x1 + x2)/2,\r\n            cy: (y1 + y2)/2,\r\n            distance\r\n        };\r\n    }\r\n\r\n    down(e: PointerEvent) {\r\n        this.pointers.push(e);\r\n        if (this.pointers.length > 1) {\r\n            this.onlock(true);\r\n        }\r\n    }\r\n\r\n    move(e: PointerEvent) {\r\n        this.pointers = this.pointers.map(p => p.pointerId === e.pointerId ? e : p)\r\n        if (this.pointers.length < 2) return;\r\n\r\n        let rect = this.el.getBoundingClientRect();\r\n\r\n        let { cx, cy, distance } = this.touches();\r\n\r\n        if (this.previous !== null) {\r\n            let delta = distance / this.previous.distance - 1;\r\n    \r\n            const ox = (rect.left - cx) * delta;\r\n            const oy = (rect.top - cy) * delta;\r\n\r\n            this.onzoom(delta, ox - (this.previous.cx - cx), oy - (this.previous.cy - cy), 'touch');\r\n        }\r\n        this.previous = { cx, cy, distance };\r\n    }\r\n\r\n    end(e: PointerEvent) {\r\n        this.previous = null;\r\n        this.onlock(false)\r\n        this.pointers = this.pointers.filter(p => p.pointerId !== e.pointerId)\r\n    }\r\n\r\n    dblclick(e: MouseEvent) {\r\n        e.preventDefault();\r\n        \r\n        const rect = this.el.getBoundingClientRect();\r\n        const delta = 4 * this.intensity;\r\n\r\n        const ox = (rect.left - e.clientX) * delta;\r\n        const oy = (rect.top - e.clientY) * delta;\r\n\r\n        this.onzoom(delta, ox, oy, 'dblclick'); \r\n    }\r\n}","import { Drag } from './drag';\r\nimport { Emitter } from '../core/emitter';\r\nimport { EventsTypes } from '../events';\r\nimport { Zoom } from './zoom';\r\n\r\nexport interface Transform { k: number; x: number; y: number }\r\nexport interface Mouse { x: number; y: number }\r\nexport type ZoomSource = 'wheel' | 'touch' | 'dblclick';\r\n\r\nexport class Area extends Emitter<EventsTypes> {\r\n\r\n    el: HTMLElement;\r\n    container: HTMLElement;\r\n    transform: Transform = { k: 1, x: 0, y: 0 };\r\n    mouse: Mouse = { x: 0, y: 0 }\r\n\r\n    private _startPosition: Transform | null = null\r\n    private _lockTranslate: boolean = false;\r\n\r\n    constructor(container: HTMLElement, emitter: Emitter<EventsTypes>) {\r\n        super(emitter);\r\n        \r\n        const el = this.el = document.createElement('div');\r\n\r\n        this.container = container;\r\n        el.style.transformOrigin = '0 0';\r\n\r\n        new Zoom(container, el, 0.1, this.onZoom.bind(this), (isLock: boolean) => this._lockTranslate = isLock);\r\n        \r\n        const drag = new Drag(container, this.onTranslate.bind(this), this.onStart.bind(this));\r\n\r\n        emitter.on('destroy', drag.destroy);\r\n\r\n        this.container.addEventListener('pointermove', this.pointermove.bind(this));\r\n\r\n        this.update();\r\n    }\r\n\r\n    update() {\r\n        const t = this.transform;\r\n\r\n        this.el.style.transform = `translate3D(${t.x}px, ${t.y}px, 0) scale(${t.k})`;\r\n    }\r\n\r\n    pointermove(e: PointerEvent) {\r\n        const { clientX, clientY } = e;\r\n        const rect = this.el.getBoundingClientRect();\r\n        const x = clientX - rect.left;\r\n        const y = clientY - rect.top;\r\n        const k = this.transform.k;\r\n        \r\n        this.mouse = { x: x / k, y: y / k };\r\n        this.trigger('mousemove', { ...this.mouse }); // TODO rename on `pointermove`\r\n    }\r\n\r\n    onStart() {\r\n        this._startPosition = { ...this.transform };\r\n    }\r\n\r\n    onTranslate(dx: number, dy: number) {\r\n        if (this._lockTranslate) return;\r\n        if (this._startPosition) this.translate(this._startPosition.x + dx, this._startPosition.y + dy);\r\n    }\r\n\r\n    onZoom(delta: number, ox: number, oy: number, source: ZoomSource) {\r\n        this.zoom(this.transform.k * (1 + delta), ox, oy, source);\r\n\r\n        this.update();\r\n    }\r\n\r\n    translate(x: number, y: number) {\r\n        const params = { transform: this.transform, x, y };\r\n\r\n        if (!this.trigger('translate', params)) return;\r\n\r\n        this.transform.x = params.x;\r\n        this.transform.y = params.y;\r\n\r\n        this.update();\r\n        this.trigger('translated');\r\n    }\r\n\r\n    zoom(zoom: number, ox = 0, oy = 0, source: ZoomSource) {\r\n        const k = this.transform.k;\r\n        const params = { transform: this.transform, zoom, source };\r\n\r\n        if (!this.trigger('zoom', params)) return;\r\n        \r\n        const d = (k - params.zoom) / ((k - zoom) || 1);\r\n\r\n        this.transform.k = params.zoom || 1;\r\n        this.transform.x += ox * d;\r\n        this.transform.y += oy * d;\r\n\r\n        this.update();\r\n        this.trigger('zoomed', { source });\r\n    }\r\n\r\n    appendChild(el: HTMLElement) {\r\n        this.el.appendChild(el)\r\n    }\r\n\r\n    removeChild(el: HTMLElement) {\r\n        this.el.removeChild(el)\r\n    }\r\n}","import { Connection } from '../connection';\r\nimport { Emitter } from '../core/emitter';\r\nimport { EventsTypes } from '../events';\r\nimport { NodeView } from './node';\r\n\r\nexport class ConnectionView extends Emitter<EventsTypes> {\r\n\r\n    connection: Connection;\r\n    inputNode: NodeView;\r\n    outputNode: NodeView;\r\n    el: HTMLElement;\r\n\r\n    constructor(connection: Connection, inputNode: NodeView, outputNode: NodeView, emitter: Emitter<EventsTypes>) {\r\n        super(emitter);\r\n        this.connection = connection;\r\n        this.inputNode = inputNode;\r\n        this.outputNode = outputNode;\r\n\r\n        this.el = document.createElement('div');\r\n        this.el.style.position = 'absolute';\r\n        this.el.style.zIndex = '-1';\r\n\r\n        this.trigger('renderconnection', { \r\n            el: this.el, \r\n            connection: this.connection, \r\n            points: this.getPoints()\r\n        });\r\n    }\r\n\r\n    getPoints() {\r\n        const [x1, y1] = this.outputNode.getSocketPosition(this.connection.output);\r\n        const [x2, y2] = this.inputNode.getSocketPosition(this.connection.input);\r\n\r\n        return [x1, y1, x2, y2];\r\n    }\r\n\r\n    update() {\r\n        this.trigger('updateconnection', { \r\n            el: this.el, \r\n            connection: this.connection, \r\n            points: this.getPoints()\r\n        });\r\n    }\r\n}","import { Control } from '../control';\r\nimport { Emitter } from '../core/emitter';\r\nimport { EventsTypes } from '../events';\r\n\r\nexport class ControlView extends Emitter<EventsTypes> {\r\n\r\n    constructor(el: HTMLElement, control: Control, emitter: Emitter<EventsTypes>) {\r\n        super(emitter);\r\n        this.trigger('rendercontrol', { el, control });\r\n    }\r\n}","import { Emitter } from '../core/emitter';\r\nimport { EventsTypes } from '../events';\r\nimport { IO } from '../io';\r\nimport { Node } from '../node';\r\n\r\nexport class SocketView extends Emitter<EventsTypes> {\r\n\r\n    el: HTMLElement;\r\n    type: string;\r\n    io: IO;\r\n    node: Node;\r\n\r\n    constructor(el: HTMLElement, type: string, io: IO, node: Node, emitter: Emitter<EventsTypes>) {\r\n        super(emitter);\r\n        this.el = el;\r\n        this.type = type;\r\n        this.io = io;\r\n        this.node = node;\r\n\r\n        this.trigger('rendersocket', { el, [type]: this.io, socket: io.socket });\r\n    }\r\n\r\n    getPosition({ position }: { position: number[] }): [number, number] {\r\n        const el = this.el;\r\n\r\n        return [\r\n            position[0] + el.offsetLeft + el.offsetWidth / 2,\r\n            position[1] + el.offsetTop + el.offsetHeight / 2\r\n        ]\r\n    }\r\n}","import { Component } from '../engine/component';\r\nimport { Control } from '../control';\r\nimport { ControlView } from './control';\r\nimport { Drag } from './drag';\r\nimport { Emitter } from '../core/emitter';\r\nimport { EventsTypes } from '../events';\r\nimport { IO } from '../io';\r\nimport { Node } from '../node';\r\nimport { SocketView } from './socket';\r\n\r\nexport class NodeView extends Emitter<EventsTypes> {\r\n\r\n    node: Node;\r\n    component: Component;\r\n    sockets = new Map<IO, SocketView>();\r\n    controls = new Map<Control, ControlView>();\r\n\r\n    el: HTMLElement;\r\n    private _startPosition: number[] = [];\r\n\r\n    constructor(node: Node, component: Component, emitter: Emitter<EventsTypes>) {\r\n        super(emitter);\r\n\r\n        this.node = node;\r\n        this.component = component;\r\n        this.el = document.createElement('div');\r\n        this.el.style.position = 'absolute';\r\n\r\n        this.el.addEventListener('contextmenu', e => this.trigger('contextmenu', { e, node: this.node }));\r\n\r\n        const drag = new Drag(this.el, this.onTranslate.bind(this), this.onSelect.bind(this), () => {\r\n            this.trigger('nodedraged', node);\r\n        });\r\n\r\n        emitter.on('noderemoved', n => n.id === node.id && drag.destroy());\r\n\r\n        this.trigger('rendernode', {\r\n            el: this.el, \r\n            node, \r\n            component: component.data, \r\n            bindSocket: this.bindSocket.bind(this),\r\n            bindControl: this.bindControl.bind(this)\r\n        });\r\n\r\n        this.update();\r\n    }\r\n\r\n    clearSockets() {\r\n        const ios: IO[] = [ ...this.node.inputs.values(), ...this.node.outputs.values()];\r\n        \r\n        this.sockets.forEach(s => {\r\n            if (!ios.includes(s.io)) this.sockets.delete(s.io);\r\n        });\r\n    }\r\n\r\n    bindSocket(el: HTMLElement, type: string, io: IO) {\r\n        this.clearSockets();\r\n        this.sockets.set(io, new SocketView(el, type, io, this.node, this));\r\n    }\r\n\r\n    bindControl(el: HTMLElement, control: Control) {\r\n        this.controls.set(control, new ControlView(el, control, this));\r\n    }\r\n\r\n    getSocketPosition(io: IO) {\r\n        const socket = this.sockets.get(io);\r\n\r\n        if (!socket) throw new Error(`Socket not fount for ${io.name} with key ${io.key}`);\r\n\r\n        return socket.getPosition(this.node);\r\n    }\r\n\r\n    onSelect(e: MouseEvent) {        \r\n        this.onStart();\r\n        this.trigger('selectnode', { node: this.node, accumulate: e.ctrlKey });\r\n    }\r\n\r\n    onStart() {\r\n        this._startPosition = [...this.node.position];\r\n    }\r\n\r\n    onTranslate(dx: number, dy: number) {\r\n        this.trigger('translatenode', { node: this.node, dx, dy });\r\n    }\r\n\r\n    onDrag(dx: number, dy: number) {\r\n        const x = this._startPosition[0] + dx;\r\n        const y = this._startPosition[1] + dy;\r\n\r\n        this.translate(x, y);\r\n    }\r\n\r\n    translate(x: number, y: number) {\r\n        const node = this.node;\r\n        const params = { node, x, y };\r\n\r\n        if (!this.trigger('nodetranslate', params)) return;\r\n\r\n        const [px, py] = node.position;\r\n        const prev: [number, number] = [px, py];\r\n\r\n        node.position[0] = params.x;\r\n        node.position[1] = params.y;\r\n\r\n        this.update();\r\n        this.trigger('nodetranslated', { node, prev });\r\n    }\r\n\r\n    update() {\r\n        const [x, y] = this.node.position;\r\n\r\n        this.el.style.transform = `translate3D(${x}px, ${y}px, 0)`;\r\n    }\r\n\r\n    remove() {\r\n        \r\n    }\r\n}","import { Area } from './area';\r\nimport { Component } from '../engine/component';\r\nimport { Connection } from '../connection';\r\nimport { ConnectionView } from './connection';\r\nimport { Emitter } from '../core/emitter';\r\nimport { EventsTypes } from '../events';\r\nimport { Node } from '../node';\r\nimport { NodeView } from './node';\r\nimport { listenWindow } from './utils';\r\n\r\nexport class EditorView extends Emitter<EventsTypes> {\r\n\r\n    container: HTMLElement;\r\n    components: Map<string, Component>;\r\n    nodes = new Map<Node, NodeView>();\r\n    connections = new Map<Connection, ConnectionView>();\r\n    area: Area;\r\n\r\n    constructor(container: HTMLElement, components: Map<string, Component>, emitter: Emitter<EventsTypes>) {\r\n        super(emitter);\r\n\r\n        this.container = container;\r\n        this.components = components;\r\n\r\n        this.container.style.overflow = 'hidden';\r\n\r\n        this.container.addEventListener('click', this.click.bind(this));\r\n        this.container.addEventListener('contextmenu', e => this.trigger('contextmenu', { e, view: this }));\r\n        emitter.on('destroy', listenWindow('resize', this.resize.bind(this)));\r\n  \r\n        this.on('nodetranslated', this.updateConnections.bind(this));\r\n            \r\n        this.area = new Area(container, this);\r\n        this.container.appendChild(this.area.el);\r\n    }\r\n\r\n    addNode(node: Node) {\r\n        const component = this.components.get(node.name);\r\n\r\n        if (!component) throw new Error(`Component ${node.name} not found`);\r\n        \r\n        const nodeView = new NodeView(node, component, this);\r\n\r\n        this.nodes.set(node, nodeView);\r\n        this.area.appendChild(nodeView.el);\r\n    }\r\n\r\n    removeNode(node: Node) {\r\n        const nodeView = this.nodes.get(node);\r\n\r\n        this.nodes.delete(node);\r\n        if (nodeView)\r\n            this.area.removeChild(nodeView.el);\r\n    }\r\n\r\n    addConnection(connection: Connection) {\r\n        if (!connection.input.node || !connection.output.node)\r\n            throw new Error('Connection input or output not added to node');\r\n\r\n        const viewInput = this.nodes.get(connection.input.node);\r\n        const viewOutput = this.nodes.get(connection.output.node);\r\n\r\n        if (!viewInput || !viewOutput)\r\n            throw new Error('View node not fount for input or output');\r\n\r\n        const connView = new ConnectionView(connection, viewInput, viewOutput, this);\r\n\r\n        this.connections.set(connection, connView);\r\n        this.area.appendChild(connView.el);\r\n    }\r\n\r\n    removeConnection(connection: Connection) {\r\n        const connView = this.connections.get(connection);\r\n\r\n        this.connections.delete(connection);\r\n        if (connView)\r\n            this.area.removeChild(connView.el);\r\n    }\r\n\r\n    updateConnections({ node }: { node: Node }) {\r\n        node.getConnections().forEach(conn => {\r\n            let connView = this.connections.get(conn);\r\n\r\n            if (!connView) throw new Error('Connection view not found');\r\n\r\n            connView.update();\r\n        });\r\n    }\r\n\r\n    resize() {\r\n        const { container } = this;\r\n\r\n        if (!container.parentElement)\r\n            throw new Error('Container doesn\\'t have parent element');\r\n\r\n        const width = container.parentElement.clientWidth;\r\n        const height = container.parentElement.clientHeight;\r\n\r\n        container.style.width = width + 'px';\r\n        container.style.height = height + 'px';\r\n    }\r\n\r\n    click(e: Event) {\r\n        const container = this.container;\r\n        \r\n        if (container !== e.target) return;\r\n        if (!this.trigger('click', { e, container })) return;\r\n    }\r\n}\r\n","import { Node } from './node';\r\n\r\nexport class Selected {\r\n\r\n    list: Node[] = [];\r\n\r\n    add(item: Node, accumulate = false) {\r\n        if (!accumulate)\r\n            this.list = [item]; \r\n        else if (!this.contains(item))\r\n            this.list.push(item);   \r\n    }\r\n\r\n    clear() {\r\n        this.list = [];\r\n    }\r\n\r\n    remove(item: Node) {\r\n        this.list.splice(this.list.indexOf(item), 1);\r\n    }\r\n\r\n    contains(item: Node) {\r\n        return this.list.indexOf(item) !== -1;\r\n    }\r\n\r\n    each(callback: (n: Node, index: number) => void) {\r\n        this.list.forEach(callback);\r\n    }\r\n}","import { Component } from '../engine/component';\r\n\r\nexport class Events {\r\n\r\n    handlers: {};\r\n\r\n    constructor(handlers: {}) {\r\n        this.handlers = {\r\n            warn: [console.warn],\r\n            error: [console.error],\r\n            componentregister: [],\r\n            destroy: [],\r\n            ...handlers\r\n        }\r\n    }\r\n}\r\n\r\nexport interface EventsTypes {\r\n    warn: string | Error;\r\n    error: string | Error;\r\n    componentregister: Component;\r\n    destroy: void;\r\n}","import { Component } from './component';\r\nimport { Connection } from './connection';\r\nimport { Control } from './control';\r\nimport { Data } from './core/data';\r\nimport { EditorView } from './view';\r\nimport { Input } from './input';\r\nimport { Node } from './node';\r\nimport { Output } from './output';\r\nimport { Socket } from './socket';\r\nimport { EventsTypes as DefaultEventsTypes, Events } from './core/events';\r\nimport { Mouse, Transform, ZoomSource } from './view/area';\r\n\r\nexport class EditorEvents extends Events {\r\n\r\n    constructor() {\r\n        super({\r\n            nodecreate: [],\r\n            nodecreated: [],\r\n            noderemove: [],\r\n            noderemoved: [],\r\n            connectioncreate: [],\r\n            connectioncreated: [],\r\n            connectionremove: [],\r\n            connectionremoved: [],\r\n            translatenode: [],\r\n            nodetranslate: [],\r\n            nodetranslated: [],\r\n            nodedraged: [],\r\n            selectnode: [],\r\n            nodeselect: [],\r\n            nodeselected: [],\r\n            rendernode: [],\r\n            rendersocket: [],\r\n            rendercontrol: [],\r\n            renderconnection: [],\r\n            updateconnection: [],\r\n            keydown: [],\r\n            keyup: [],\r\n            translate: [],\r\n            translated: [],\r\n            zoom: [],\r\n            zoomed: [],\r\n            click: [],\r\n            mousemove: [],\r\n            contextmenu: [],\r\n            import: [],\r\n            export: [],\r\n            process: []\r\n        });\r\n    }    \r\n}\r\n\r\nexport interface EventsTypes extends DefaultEventsTypes {\r\n    componentregister: Component;\r\n    nodecreate: Node;\r\n    nodecreated: Node;\r\n    noderemove: Node;\r\n    noderemoved: Node;\r\n    connectioncreate: { input: Input; output: Output };\r\n    connectioncreated: Connection;\r\n    connectionremove: Connection;\r\n    connectionremoved: Connection;\r\n    translatenode: { node: Node; dx: number; dy: number };\r\n    nodetranslate: { node: Node; x: number; y: number };\r\n    nodetranslated: { node: Node; prev: [number, number] };\r\n    nodedraged: Node;\r\n    selectnode: {\r\n        node: Node;\r\n        accumulate: boolean;\r\n    };\r\n    nodeselect: Node;\r\n    nodeselected: Node;\r\n    rendernode: {\r\n        el: HTMLElement;\r\n        node: Node;\r\n        component: object;\r\n        bindSocket: Function;\r\n        bindControl: Function;\r\n    };\r\n    rendersocket: {\r\n        el: HTMLElement;\r\n        input?: Input;\r\n        output?: Output;\r\n        socket: Socket;\r\n    };\r\n    rendercontrol: {\r\n        el: HTMLElement;\r\n        control: Control;\r\n    };\r\n    renderconnection: {\r\n        el: HTMLElement;\r\n        connection: Connection;\r\n        points: number[];\r\n    };\r\n    updateconnection: {\r\n        el: HTMLElement;\r\n        connection: Connection;\r\n        points: number[];\r\n    };\r\n    keydown: KeyboardEvent;\r\n    keyup: KeyboardEvent;\r\n    translate: {\r\n        transform: Transform;\r\n        x: number;\r\n        y: number;\r\n    };\r\n    translated: void;\r\n    zoom: {\r\n        transform: Transform;\r\n        zoom: number;\r\n        source: ZoomSource;\r\n    };\r\n    zoomed: {\r\n        source: ZoomSource;\r\n    };\r\n    click: {\r\n        e: Event;\r\n        container: HTMLElement;\r\n    };\r\n    mousemove: Mouse;\r\n    contextmenu: {\r\n        e: MouseEvent;\r\n        view?: EditorView;\r\n        node?: Node;\r\n    };\r\n    import: Data;\r\n    export: Data;\r\n    process: void;\r\n}","import { Component } from './component';\r\nimport { Connection } from './connection';\r\nimport { Context } from './core/context';\r\nimport { Data } from './core/data';\r\nimport { EditorView } from './view/index';\r\nimport { Input } from './input';\r\nimport { Node } from './node';\r\nimport { Output } from './output';\r\nimport { Selected } from './selected';\r\nimport { Validator } from './core/validator';\r\nimport { listenWindow } from './view/utils';\r\nimport { EditorEvents, EventsTypes } from './events';\r\n\r\nexport class NodeEditor extends Context<EventsTypes> {\r\n\r\n    nodes: Node[] = [];\r\n    selected = new Selected();\r\n    view: EditorView;\r\n\r\n    constructor(id: string, container: HTMLElement) {\r\n        super(id, new EditorEvents());\r\n        \r\n        this.view = new EditorView(container, this.components, this);\r\n\r\n        this.on('destroy', listenWindow('keydown', e => this.trigger('keydown', e)));\r\n        this.on('destroy', listenWindow('keyup', e => this.trigger('keyup', e)));\r\n\r\n        this.on('selectnode', ({ node, accumulate }) => this.selectNode(node, accumulate));\r\n        this.on('nodeselected', () => this.selected.each(n => {\r\n            const nodeView = this.view.nodes.get(n);\r\n\r\n            nodeView && nodeView.onStart()\r\n        }));\r\n        this.on('translatenode', ({ dx, dy }) => this.selected.each(n => {\r\n            const nodeView = this.view.nodes.get(n);\r\n\r\n            nodeView && nodeView.onDrag(dx, dy)\r\n        }));\r\n    }\r\n\r\n    addNode(node: Node) {\r\n        if (!this.trigger('nodecreate', node)) return;\r\n\r\n        this.nodes.push(node);\r\n        this.view.addNode(node);\r\n        \r\n        this.trigger('nodecreated', node);\r\n    }\r\n\r\n    removeNode(node: Node) {\r\n        if (!this.trigger('noderemove', node)) return;\r\n\r\n        node.getConnections().forEach(c => this.removeConnection(c));\r\n\r\n        this.nodes.splice(this.nodes.indexOf(node), 1);\r\n        this.view.removeNode(node);\r\n\r\n        this.trigger('noderemoved', node);\r\n    }\r\n\r\n    connect(output: Output, input: Input, data: unknown = {}) {\r\n        if (!this.trigger('connectioncreate', { output, input })) return;\r\n\r\n        try {\r\n            const connection = output.connectTo(input);\r\n\r\n            connection.data = data;\r\n            this.view.addConnection(connection);\r\n\r\n            this.trigger('connectioncreated', connection);\r\n        } catch (e) {\r\n            this.trigger('warn', e)\r\n        }\r\n    }\r\n\r\n    removeConnection(connection: Connection) {\r\n        if (!this.trigger('connectionremove', connection)) return;\r\n            \r\n        this.view.removeConnection(connection);\r\n        connection.remove();\r\n\r\n        this.trigger('connectionremoved', connection);\r\n    }\r\n\r\n    selectNode(node: Node, accumulate: boolean = false) {\r\n        if (this.nodes.indexOf(node) === -1) \r\n            throw new Error('Node not exist in list');\r\n        \r\n        if (!this.trigger('nodeselect', node)) return;\r\n\r\n        this.selected.add(node, accumulate);\r\n        \r\n        this.trigger('nodeselected', node);\r\n    }\r\n\r\n    getComponent(name: string) {\r\n        const component = this.components.get(name);\r\n\r\n        if (!component)\r\n            throw `Component ${name} not found`;\r\n        \r\n        return component as Component;\r\n    }\r\n\r\n    register(component: Component) {\r\n        super.register(component)\r\n        component.editor = this;\r\n    }\r\n\r\n    clear() {\r\n        [...this.nodes].forEach(node => this.removeNode(node));\r\n    }\r\n\r\n    toJSON() {\r\n        const data: Data = { id: this.id, nodes: {} };\r\n        \r\n        this.nodes.forEach(node => data.nodes[node.id] = node.toJSON());\r\n        this.trigger('export', data);\r\n        return data;\r\n    }\r\n\r\n    beforeImport(json: Data) {\r\n        const checking = Validator.validate(this.id, json);\r\n        \r\n        if (!checking.success) {\r\n            this.trigger('warn', checking.msg);\r\n            return false;\r\n        }\r\n        \r\n        this.silent = true;\r\n        this.clear();\r\n        this.trigger('import', json);\r\n        return true;\r\n    }\r\n\r\n    afterImport() {\r\n        this.silent = false;\r\n        return true;\r\n    }\r\n\r\n    async fromJSON(json: Data) {\r\n        if (!this.beforeImport(json)) return false;\r\n        const nodes: {[key: string]: Node} = {};\r\n\r\n        try {\r\n            await Promise.all(Object.keys(json.nodes).map(async id => {\r\n                const node = json.nodes[id];\r\n                const component = this.getComponent(node.name);\r\n\r\n                nodes[id] = await component.build(Node.fromJSON(node));\r\n                this.addNode(nodes[id]);\r\n            }));\r\n        \r\n            Object.keys(json.nodes).forEach(id => {\r\n                const jsonNode = json.nodes[id];\r\n                const node = nodes[id];\r\n                \r\n                Object.keys(jsonNode.outputs).forEach(key => {\r\n                    const outputJson = jsonNode.outputs[key];\r\n\r\n                    outputJson.connections.forEach(jsonConnection => {\r\n                        const nodeId = jsonConnection.node;\r\n                        const data = jsonConnection.data;\r\n                        const targetOutput = node.outputs.get(key);\r\n                        const targetInput = nodes[nodeId].inputs.get(jsonConnection.input);\r\n\r\n                        if (!targetOutput || !targetInput) {\r\n                            return this.trigger('error', `IO not found for node ${node.id}`);\r\n                        }\r\n\r\n                        this.connect(targetOutput, targetInput, data);\r\n                    });\r\n                });\r\n\r\n            });\r\n        } catch (e) {\r\n            this.trigger('warn', e);\r\n            return !this.afterImport();\r\n        }\r\n\r\n        return this.afterImport();\r\n    }\r\n}\r\n","import { Connection } from './connection';\r\nimport { IO } from './io';\r\nimport { Input } from './input';\r\nimport { OutputData } from './core/data';\r\nimport { Socket } from './socket';\r\n\r\nexport class Output extends IO {\r\n  \r\n    constructor(key: string, title: string, socket: Socket, multiConns: boolean = true) {\r\n        super(key, title, socket, multiConns);\r\n    }\r\n    \r\n    hasConnection() {\r\n        return this.connections.length > 0;\r\n    }\r\n\r\n    connectTo(input: Input) {\r\n        if (!this.socket.compatibleWith(input.socket))\r\n            throw new Error('Sockets not compatible');\r\n        if (!input.multipleConnections && input.hasConnection())\r\n            throw new Error('Input already has one connection');\r\n        if (!this.multipleConnections && this.hasConnection())\r\n            throw new Error('Output already has one connection');\r\n\r\n        const connection = new Connection(this, input);\r\n\r\n        this.connections.push(connection);\r\n        return connection;\r\n    }\r\n\r\n    connectedTo(input: Input) {\r\n        return this.connections.some((item) => {\r\n            return item.input === input;\r\n        });\r\n    }\r\n\r\n    toJSON(): OutputData {\r\n        return {\r\n            'connections': this.connections.map(c => {\r\n                if (!c.input.node) throw new Error('Node not added to Input');\r\n\r\n                return {\r\n                    node: c.input.node.id,\r\n                    input: c.input.key,\r\n                    data: c.data\r\n                }\r\n            })\r\n        };\r\n    }\r\n}","export class Socket {\r\n\r\n    name: string;\r\n    data: unknown;\r\n    compatible: Socket[] = [];\r\n\r\n    constructor(name: string, data = {}) {\r\n        this.name = name;\r\n        this.data = data;\r\n        this.compatible = [];\r\n    }\r\n\r\n    combineWith(socket: Socket) {\r\n        this.compatible.push(socket);\r\n    }\r\n\r\n    compatibleWith(socket: Socket) {\r\n        return this === socket || this.compatible.includes(socket);\r\n    }\r\n}","import { InputConnectionData, NodeData, NodesData } from '../core/data';\r\n\r\nfunction intersect<T>(array1: T[], array2: T[]) {\r\n    return array1.filter(value => -1 !== array2.indexOf(value));\r\n}\r\n\r\nexport class Recursion {\r\n\r\n    nodes: NodesData;\r\n\r\n    constructor(nodes: NodesData) {\r\n        this.nodes = nodes;\r\n    }\r\n    \r\n    extractInputNodes(node: NodeData): NodeData[] {\r\n        return Object.keys(node.inputs).reduce((acc: NodeData[], key: string) => {\r\n            const { connections } = node.inputs[key];\r\n            const nodesData = (connections || []).reduce((b: NodeData[], c: InputConnectionData) => {\r\n                return [...b, this.nodes[c.node]];\r\n            }, []);\r\n\r\n            return [...acc, ...nodesData]\r\n        }, []);\r\n    }\r\n\r\n    findSelf(list: NodeData[], inputNodes: NodeData[]): NodeData | null {\r\n        const inters = intersect<NodeData>(list, inputNodes);\r\n\r\n        if (inters.length)\r\n            return inters[0];\r\n        \r\n        for (let node of inputNodes) {\r\n            let l = [node, ...list];\r\n            let inter = this.findSelf(l, this.extractInputNodes(node));\r\n\r\n            if (inter)\r\n                return inter;\r\n        }\r\n\r\n        return null;\r\n    }\r\n\r\n    detect(): NodeData | null {\r\n        const nodesArr = Object.keys(this.nodes).map(id => this.nodes[id]);\r\n\r\n        for (let node of nodesArr) {\r\n            let inters = this.findSelf([node], this.extractInputNodes(node));\r\n\r\n            if (inters)\r\n                return inters;\r\n        }\r\n\r\n        return null;\r\n    }\r\n}","export const State = { AVAILABLE: 0, PROCESSED: 1, ABORT: 2 }","import { Events } from '../core/events';\r\n\r\nexport class EngineEvents extends Events {\r\n\r\n    constructor() {\r\n        super({});\r\n    }    \r\n}\r\nexport interface EventsTypes {\r\n}","import { Component } from './component';\r\nimport { Context } from '../core/context';\r\nimport { Recursion } from './recursion';\r\nimport { State } from './state';\r\nimport { Validator } from '../core/validator';\r\nimport { Data, NodeData, WorkerOutputs } from '../core/data';\r\nimport { EngineEvents, EventsTypes } from './events';\r\nexport { Component, Recursion };\r\n\r\ninterface EngineNode extends NodeData {\r\n    busy: boolean;\r\n    unlockPool: (() => void)[];\r\n    outputData: WorkerOutputs;\r\n}\r\n\r\nexport class Engine extends Context<EventsTypes> {\r\n\r\n    args: unknown[] = [];\r\n    data: Data | null = null;\r\n    state = State.AVAILABLE;\r\n    onAbort = () => { };\r\n\r\n    constructor(id: string) {\r\n        super(id, new EngineEvents());\r\n    }\r\n\r\n    public clone() {\r\n        const engine = new Engine(this.id);\r\n\r\n        this.components.forEach(c => engine.register(c));\r\n\r\n        return engine;\r\n    }\r\n\r\n    async throwError (message: string, data: unknown = null) {\r\n        await this.abort();\r\n        this.trigger('error', { message, data });\r\n        this.processDone();\r\n\r\n        return 'error';\r\n    }\r\n\r\n    private processStart() {\r\n        if (this.state === State.AVAILABLE) {  \r\n            this.state = State.PROCESSED;\r\n            return true;\r\n        }\r\n\r\n        if (this.state === State.ABORT) {\r\n            return false;\r\n        }\r\n\r\n        console.warn(`The process is busy and has not been restarted.\r\n                Use abort() to force it to complete`);\r\n        return false;\r\n    }\r\n\r\n    private processDone() {\r\n        const success = this.state !== State.ABORT;\r\n\r\n        this.state = State.AVAILABLE;\r\n        \r\n        if (!success) {\r\n            this.onAbort();\r\n            this.onAbort = () => { }\r\n        }    \r\n\r\n        return success;\r\n    }\r\n\r\n    public async abort() {\r\n        return new Promise(ret => {\r\n            if (this.state === State.PROCESSED) {\r\n                this.state = State.ABORT;\r\n                this.onAbort = ret;\r\n            }\r\n            else if (this.state === State.ABORT) {\r\n                this.onAbort();\r\n                this.onAbort = ret;\r\n            }\r\n            else\r\n                ret();\r\n        });\r\n    }\r\n\r\n    private async lock(node: EngineNode) {\r\n        return new Promise(res => {\r\n            node.unlockPool = node.unlockPool || [];\r\n            if (node.busy && !node.outputData)\r\n                node.unlockPool.push(res);\r\n            else \r\n                res();\r\n            \r\n            node.busy = true;\r\n        });    \r\n    }\r\n\r\n    unlock(node: EngineNode) {\r\n        node.unlockPool.forEach(a => a());\r\n        node.unlockPool = [];\r\n        node.busy = false;\r\n    }\r\n\r\n    private async extractInputData(node: NodeData) {\r\n        const obj: {[id: string]: any} = {};\r\n\r\n        for (let key of Object.keys(node.inputs)) {\r\n            const input = node.inputs[key];\r\n            const conns = input.connections;\r\n            const connData = await Promise.all(conns.map(async (c) => {\r\n                const prevNode = (this.data as Data).nodes[c.node];\r\n\r\n                const outputs = await this.processNode(prevNode as EngineNode);\r\n\r\n                if (!outputs) \r\n                    this.abort();\r\n                else\r\n                    return outputs[c.output];\r\n            }));\r\n\r\n            obj[key] = connData;\r\n        }\r\n\r\n        return obj;\r\n    }\r\n\r\n    private async processWorker(node: NodeData) {\r\n        const inputData = await this.extractInputData(node);\r\n        const component = this.components.get(node.name) as Component;\r\n        const outputData = {};\r\n\r\n        try {\r\n            await component.worker(node, inputData, outputData, ...this.args);\r\n        } catch (e) {\r\n            this.abort();\r\n            this.trigger('warn', e);\r\n        }\r\n\r\n        return outputData;\r\n    }\r\n\r\n    private async processNode(node: EngineNode) {\r\n        if (this.state === State.ABORT || !node)\r\n            return null;\r\n        \r\n        await this.lock(node);\r\n\r\n        if (!node.outputData) {\r\n            node.outputData = await this.processWorker(node);\r\n        }\r\n\r\n        this.unlock(node);\r\n        return node.outputData;\r\n    }\r\n\r\n    private async forwardProcess(node: NodeData) {\r\n        if (this.state === State.ABORT)\r\n            return null;\r\n\r\n        return await Promise.all(Object.keys(node.outputs).map(async (key) => {\r\n            const output = node.outputs[key];\r\n            \r\n            return await Promise.all(output.connections.map(async (c) => {\r\n                const nextNode = (this.data as Data).nodes[c.node];\r\n\r\n                await this.processNode(nextNode as EngineNode);\r\n                await this.forwardProcess(nextNode);\r\n            }));\r\n        }));\r\n    }\r\n\r\n    copy(data: Data) {\r\n        data = Object.assign({}, data);\r\n        data.nodes = Object.assign({}, data.nodes);\r\n        \r\n        Object.keys(data.nodes).forEach(key => {\r\n            data.nodes[key] = Object.assign({}, data.nodes[key])\r\n        });\r\n        return data;\r\n    }\r\n\r\n    async validate(data: Data) {\r\n        const checking = Validator.validate(this.id, data);\r\n        const recursion = new Recursion(data.nodes);\r\n\r\n        if (!checking.success)\r\n            return await this.throwError(checking.msg);  \r\n        \r\n        const recurrentNode = recursion.detect();\r\n\r\n        if (recurrentNode)\r\n            return await this.throwError('Recursion detected', recurrentNode);      \r\n         \r\n        return true;\r\n    }\r\n\r\n    private async processStartNode(id: string | number | null) {\r\n        if (!id) return;\r\n\r\n        let startNode = (this.data as Data).nodes[id];\r\n\r\n        if (!startNode)\r\n            return await this.throwError('Node with such id not found');   \r\n        \r\n        await this.processNode(startNode as EngineNode);\r\n        await this.forwardProcess(startNode);\r\n    }\r\n\r\n    private async processUnreachable() {\r\n        const data = this.data as Data;\r\n\r\n        for (let i in data.nodes) { // process nodes that have not been reached\r\n            const node = data.nodes[i] as EngineNode;\r\n\r\n            if (typeof node.outputData === 'undefined') {\r\n                await this.processNode(node);\r\n                await this.forwardProcess(node);\r\n            }\r\n        }\r\n    }\r\n\r\n    async process<T extends unknown[]>(data: Data, startId: number | string | null = null, ...args: T) {\r\n        if (!this.processStart()) return;\r\n        if (!this.validate(data)) return;    \r\n        \r\n        this.data = this.copy(data);\r\n        this.args = args;\r\n        \r\n        await this.processStartNode(startId);\r\n        await this.processUnreachable();\r\n        \r\n        return this.processDone()?'success':'aborted';\r\n    }\r\n}","import { Component } from './component';\r\nimport { Connection } from './connection';\r\nimport { Control } from './control';\r\nimport { Emitter } from './core/emitter';\r\nimport { IO } from './io';\r\nimport { Input } from './input';\r\nimport { Node } from './node';\r\nimport { NodeEditor } from './editor';\r\nimport { Output } from './output';\r\nimport { Socket } from './socket';\r\nimport { Engine, Recursion } from './engine/index';\r\n\r\nexport { Engine, Recursion } from './engine/index';\r\nexport { Component } from './component';\r\nexport { Control } from './control';\r\nexport { Connection } from './connection';\r\nexport { Emitter } from './core/emitter';\r\nexport { Input } from './input';\r\nexport { IO } from './io';\r\nexport { Node } from './node';\r\nexport { NodeEditor } from './editor';\r\nexport { Output } from './output';\r\nexport { Socket } from './socket';\r\n\r\nexport default {\r\n    Engine,\r\n    Recursion,\r\n    Component,\r\n    Control,\r\n    Connection,\r\n    Emitter,\r\n    Input,\r\n    IO,\r\n    Node,\r\n    NodeEditor,\r\n    Output,\r\n    Socket\r\n}"],"names":["Component","name","Node","Map","id","incrementId","list","item","prop","has","key","Error","set","control","_add","controls","parent","input","inputs","removeConnections","node","output","outputs","ios","values","connections","reduce","arr","io","reduceIO","Array","from","obj","toJSON","data","position","latestId","json","x","y","Math","max","builder","build","ComponentWorker","Connection","addConnection","removeConnection","Control","constructor","TypeError","getNode","Emitter","events","handlers","names","handler","split","forEach","push","params","r","e","isArray","IO","socket","multiConns","multipleConnections","connection","splice","indexOf","Input","title","length","hasConnection","map","c","Validator","isValidId","nodes","Object","test","id1","id2","msg","isValidData","success","Boolean","join","Context","plugins","components","plugin","options","install","component","trigger","listenWindow","event","window","addEventListener","removeEventListener","Drag","el","onTranslate","_x","_y","_e","onStart","onDrag","pointerStart","destroy","initEvents","style","touchAction","down","bind","destroyMove","move","destroyUp","up","stopPropagation","pageX","pageY","preventDefault","delta","zoom","getBoundingClientRect","width","offsetWidth","Zoom","container","intensity","onzoom","onlock","wheel","end","dblclick","rect","wheelDelta","deltaY","ox","left","clientX","oy","top","clientY","touches","pointers","x1","y1","x2","y2","distance","sqrt","pow","cx","cy","p","pointerId","previous","filter","Area","emitter","k","document","createElement","transformOrigin","onZoom","isLock","_lockTranslate","drag","on","pointermove","update","t","transform","mouse","_startPosition","dx","dy","translate","source","d","appendChild","removeChild","ConnectionView","inputNode","outputNode","zIndex","points","getPoints","getSocketPosition","ControlView","SocketView","type","offsetLeft","offsetTop","offsetHeight","NodeView","onSelect","n","bindSocket","bindControl","sockets","s","includes","clearSockets","get","getPosition","accumulate","ctrlKey","px","py","prev","EditorView","overflow","click","view","resize","updateConnections","area","nodeView","viewInput","viewOutput","connView","getConnections","conn","parentElement","clientWidth","height","clientHeight","target","Selected","contains","callback","Events","warn","console","error","componentregister","EditorEvents","nodecreate","nodecreated","noderemove","noderemoved","connectioncreate","connectioncreated","connectionremove","connectionremoved","translatenode","nodetranslate","nodetranslated","nodedraged","selectnode","nodeselect","nodeselected","rendernode","rendersocket","rendercontrol","renderconnection","updateconnection","keydown","keyup","translated","zoomed","mousemove","contextmenu","process","NodeEditor","selectNode","selected","each","addNode","removeNode","connectTo","remove","add","editor","checking","validate","silent","clear","beforeImport","Promise","all","keys","getComponent","fromJSON","jsonNode","outputJson","jsonConnection","nodeId","targetOutput","targetInput","connect","afterImport","Output","compatibleWith","some","Socket","compatible","intersect","array1","array2","value","Recursion","acc","nodesData","b","inputNodes","inters","l","inter","findSelf","extractInputNodes","nodesArr","State","AVAILABLE","PROCESSED","ABORT","EngineEvents","Engine","engine","register","message","abort","processDone","state","onAbort","ret","res","unlockPool","busy","outputData","a","conns","prevNode","processNode","connData","extractInputData","inputData","worker","args","lock","processWorker","unlock","nextNode","forwardProcess","assign","recursion","throwError","recurrentNode","detect","startNode","i","startId","processStart","copy","processStartNode","processUnreachable"],"mappings":"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"}